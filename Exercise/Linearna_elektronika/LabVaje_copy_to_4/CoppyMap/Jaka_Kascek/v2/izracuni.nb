(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12934,        319]
NotebookOptionsPosition[     12268,        293]
NotebookOutlinePosition[     12608,        308]
CellTagsIndexPosition[     12565,        305]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"a", ",", "Rs", ",", "Vsgq"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vp", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vm", "=", 
   RowBox[{"-", "9"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsi", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kp", "=", 
   RowBox[{"0.5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vtp", "=", 
   RowBox[{"-", "0.5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WL", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rl", "=", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", "=", 
   RowBox[{"C2", "=", 
    RowBox[{"Cs", "=", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Idq", "=", 
   RowBox[{"0.5", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "3"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Av", "=", 
   RowBox[{"-", "15"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rin", "=", "30000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Kp", "=", 
  RowBox[{"0.5", "*", "kp", "*", "WL"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vsdq", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fRin", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"R1", "*", 
      RowBox[{"R2", "/", 
       RowBox[{"(", 
        RowBox[{"R1", "+", "R2"}], ")"}]}]}], ")"}], "==", "Rin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fRld", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Rl", "*", 
      RowBox[{"Rd", "/", 
       RowBox[{"(", 
        RowBox[{"Rl", "+", "Rd"}], ")"}]}]}], ")"}], "\[Equal]", "Rld"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gm", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Kp", "*", "Idq"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"Idq", "\[Equal]", 
      RowBox[{"Kp", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Vsgq", "+", "Vtp"}], ")"}], "^", "2"}]}]}], ",", "Vsgq"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"a", "=", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "//", 
   "Flatten"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.718639368485809*^9, 3.718639833814495*^9}, {
   3.718639918432069*^9, 3.7186400976388445`*^9}, {3.718640207168295*^9, 
   3.7186402192868276`*^9}, {3.7186402512258124`*^9, 3.718640296206687*^9}, {
   3.718640378855363*^9, 3.7186404844104385`*^9}, {3.7186405641658554`*^9, 
   3.718640626617322*^9}, {3.7186407200413947`*^9, 3.718640771446252*^9}, {
   3.718640843364255*^9, 3.718640856634551*^9}, {3.718640987537761*^9, 
   3.718641022930934*^9}, {3.718641342331292*^9, 3.718641370408885*^9}, {
   3.7186414303385515`*^9, 3.718641432950561*^9}, {3.718641481885912*^9, 
   3.7186414837108307`*^9}, {3.7186415602081137`*^9, 3.7186415612859373`*^9}, 
   3.718641666585309*^9, {3.7188896410144024`*^9, 3.718889652986438*^9}, {
   3.718890092343068*^9, 3.71889009277756*^9}, {3.7188915294400587`*^9, 
   3.7188915905769205`*^9}, 3.71889162425443*^9}],

Cell[BoxData["0.00375`"], "Output",
 CellChangeTimes->{
  3.7188896834320908`*^9, 3.718890098515541*^9, {3.7188915384590874`*^9, 
   3.718891591060244*^9}, 3.718891624839823*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Vsgq", "\[Rule]", "0.8651483716701107`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7188896834320908`*^9, 3.718890098515541*^9, {3.7188915384590874`*^9, 
   3.718891591060244*^9}, 3.7188916248418226`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Vsgq", " ", "=", "0.8651483716701107"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"b", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"Av", "\[Equal]", 
        RowBox[{
         RowBox[{"-", "gm"}], "*", "Rld", "*", 
         RowBox[{"Rin", "/", 
          RowBox[{"(", 
           RowBox[{"Rsi", "+", "Rin"}], ")"}]}]}]}], ",", "Rld"}], "]"}], "//",
      "Flatten"}]}], "\[IndentingNewLine]", 
   RowBox[{"c", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{"fRld", ",", "Rd"}], "]"}], "/.", "b"}], "//", "Flatten"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"d", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Rs", "*", "Idq"}], "+", "Vsdq", "+", 
          RowBox[{"Rd", "*", "Idq"}], "+", "Vm", "-", "Vp"}], "\[Equal]", 
         "0"}], ",", "Rs"}], "]"}], "/.", "c"}], "//", "Flatten"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"e", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Rs", "*", "Idq"}], "+", "Vsgq", "-", 
          RowBox[{
           RowBox[{"Rin", "/", "R2"}], 
           RowBox[{"(", 
            RowBox[{"Vp", "-", "Vm"}], ")"}]}]}], "\[Equal]", "0"}], ",", 
        "R2"}], "]"}], "/.", "d"}], "//", "Flatten"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"f", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"R1", "*", 
          RowBox[{"R2", "/", 
           RowBox[{"(", 
            RowBox[{"R1", "+", "R2"}], ")"}]}]}], "\[Equal]", "Rin"}], ",", 
        "R1"}], "]"}], "/.", "e"}], "//", "Flatten"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7186406019502335`*^9, 3.718640604639685*^9}, {
   3.7186406466770134`*^9, 3.718640694522793*^9}, {3.7186407826746016`*^9, 
   3.718640865550195*^9}, {3.718640909649907*^9, 3.7186409787354727`*^9}, {
   3.718641035063445*^9, 3.718641325555354*^9}, {3.7186414089027853`*^9, 
   3.7186415218377767`*^9}, {3.7186415655578313`*^9, 3.718641596295858*^9}, {
   3.718641630626277*^9, 3.718641869934043*^9}, {3.718642207146551*^9, 
   3.718642231192172*^9}, {3.7188897000466013`*^9, 3.7188897011633387`*^9}, 
   3.7188899073493147`*^9, {3.7188899903979225`*^9, 3.7188899998570795`*^9}, {
   3.718890034310917*^9, 3.718890081597522*^9}, {3.718890239007611*^9, 
   3.718890279419804*^9}, {3.7188903098848925`*^9, 3.7188903870510883`*^9}, {
   3.7188904325678005`*^9, 3.718890500686079*^9}, {3.7188908314935727`*^9, 
   3.718890835897512*^9}, {3.718890890718151*^9, 3.7188910242704153`*^9}, {
   3.7188910598341837`*^9, 3.718891099594761*^9}, {3.7188916012880807`*^9, 
   3.7188916384639273`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rld", "\[Rule]", "5568.512667969189`"}], "}"}]], "Output",
 CellChangeTimes->{{3.718641028354387*^9, 3.718641056881283*^9}, {
   3.71864115611271*^9, 3.7186411832880583`*^9}, 3.7186412248078756`*^9, 
   3.7186412654357834`*^9, 3.7186412979694147`*^9, {3.7186415230599046`*^9, 
   3.71864153180687*^9}, {3.7186416407688684`*^9, 3.7186416631634607`*^9}, {
   3.718641739206485*^9, 3.7186417966260414`*^9}, {3.7186418296473017`*^9, 
   3.718641871061852*^9}, {3.718642216341601*^9, 3.718642231667364*^9}, {
   3.7188896887973723`*^9, 3.7188897041201982`*^9}, {3.718890009258875*^9, 
   3.7188901038035884`*^9}, {3.7188904745375896`*^9, 3.7188905012909017`*^9}, 
   3.7188908364008474`*^9, {3.7188909142648907`*^9, 3.718891026273755*^9}, 
   3.718891100116109*^9, {3.7188916098157806`*^9, 3.718891639797818*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rd", "\[Rule]", "12565.787174251755`"}], "}"}]], "Output",
 CellChangeTimes->{{3.718641028354387*^9, 3.718641056881283*^9}, {
   3.71864115611271*^9, 3.7186411832880583`*^9}, 3.7186412248078756`*^9, 
   3.7186412654357834`*^9, 3.7186412979694147`*^9, {3.7186415230599046`*^9, 
   3.71864153180687*^9}, {3.7186416407688684`*^9, 3.7186416631634607`*^9}, {
   3.718641739206485*^9, 3.7186417966260414`*^9}, {3.7186418296473017`*^9, 
   3.718641871061852*^9}, {3.718642216341601*^9, 3.718642231667364*^9}, {
   3.7188896887973723`*^9, 3.7188897041201982`*^9}, {3.718890009258875*^9, 
   3.7188901038035884`*^9}, {3.7188904745375896`*^9, 3.7188905012909017`*^9}, 
   3.7188908364008474`*^9, {3.7188909142648907`*^9, 3.718891026273755*^9}, 
   3.718891100116109*^9, {3.7188916098157806`*^9, 3.7188916398008213`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rs", "\[Rule]", "5434.212825748245`"}], "}"}]], "Output",
 CellChangeTimes->{{3.718641028354387*^9, 3.718641056881283*^9}, {
   3.71864115611271*^9, 3.7186411832880583`*^9}, 3.7186412248078756`*^9, 
   3.7186412654357834`*^9, 3.7186412979694147`*^9, {3.7186415230599046`*^9, 
   3.71864153180687*^9}, {3.7186416407688684`*^9, 3.7186416631634607`*^9}, {
   3.718641739206485*^9, 3.7186417966260414`*^9}, {3.7186418296473017`*^9, 
   3.718641871061852*^9}, {3.718642216341601*^9, 3.718642231667364*^9}, {
   3.7188896887973723`*^9, 3.7188897041201982`*^9}, {3.718890009258875*^9, 
   3.7188901038035884`*^9}, {3.7188904745375896`*^9, 3.7188905012909017`*^9}, 
   3.7188908364008474`*^9, {3.7188909142648907`*^9, 3.718891026273755*^9}, 
   3.718891100116109*^9, {3.7188916098157806`*^9, 3.718891639801823*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "ratnz"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Solve was unable to solve the system with inexact \
coefficients. The answer was obtained by solving a corresponding exact system \
and numericizing the result. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/Solve\\\", ButtonNote -> \
\\\"Solve::ratnz\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.7188904746326528`*^9, 3.7188905013869658`*^9}, 
   3.7188908364809017`*^9, {3.718890914345945*^9, 3.718891026353808*^9}, 
   3.718891100195161*^9, {3.718891609895834*^9, 3.718891639876872*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"R2", "\[Rule]", "150743.04662243716`"}], "}"}]], "Output",
 CellChangeTimes->{{3.718641028354387*^9, 3.718641056881283*^9}, {
   3.71864115611271*^9, 3.7186411832880583`*^9}, 3.7186412248078756`*^9, 
   3.7186412654357834`*^9, 3.7186412979694147`*^9, {3.7186415230599046`*^9, 
   3.71864153180687*^9}, {3.7186416407688684`*^9, 3.7186416631634607`*^9}, {
   3.718641739206485*^9, 3.7186417966260414`*^9}, {3.7186418296473017`*^9, 
   3.718641871061852*^9}, {3.718642216341601*^9, 3.718642231667364*^9}, {
   3.7188896887973723`*^9, 3.7188897041201982`*^9}, {3.718890009258875*^9, 
   3.7188901038035884`*^9}, {3.7188904745375896`*^9, 3.7188905012909017`*^9}, 
   3.7188908364008474`*^9, {3.7188909142648907`*^9, 3.718891026273755*^9}, 
   3.718891100116109*^9, 3.7188916098157806`*^9, 3.7188916398788743`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"R1", "\[Rule]", "37453.84537806384`"}], "}"}]], "Output",
 CellChangeTimes->{{3.718641028354387*^9, 3.718641056881283*^9}, {
   3.71864115611271*^9, 3.7186411832880583`*^9}, 3.7186412248078756`*^9, 
   3.7186412654357834`*^9, 3.7186412979694147`*^9, {3.7186415230599046`*^9, 
   3.71864153180687*^9}, {3.7186416407688684`*^9, 3.7186416631634607`*^9}, {
   3.718641739206485*^9, 3.7186417966260414`*^9}, {3.7186418296473017`*^9, 
   3.718641871061852*^9}, {3.718642216341601*^9, 3.718642231667364*^9}, {
   3.7188896887973723`*^9, 3.7188897041201982`*^9}, {3.718890009258875*^9, 
   3.7188901038035884`*^9}, {3.7188904745375896`*^9, 3.7188905012909017`*^9}, 
   3.7188908364008474`*^9, {3.7188909142648907`*^9, 3.718891026273755*^9}, 
   3.718891100116109*^9, 3.7188916098157806`*^9, 3.7188916398808746`*^9}]
}, Open  ]]
},
WindowSize->{767, 848},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3314, 92, 412, "Input"],
Cell[3897, 116, 178, 3, 31, "Output"],
Cell[4078, 121, 245, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4360, 131, 2937, 74, 232, "Input"],
Cell[7300, 207, 848, 12, 31, "Output"],
Cell[8151, 221, 850, 12, 31, "Output"],
Cell[9004, 235, 847, 12, 31, "Output"],
Cell[9854, 249, 697, 13, 39, "Message"],
Cell[10554, 264, 848, 12, 31, "Output"],
Cell[11405, 278, 847, 12, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
